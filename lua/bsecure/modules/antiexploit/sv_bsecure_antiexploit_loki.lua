-- Sorry Daave :)
bSecure.AntiExploit.FlaggedNets = {"fp_chatText","DataSend","withdrawop","NGII_TakeMoney","NET_DoPrinterAction","BM2.Command.SellBitcoins","fg_printer_money","icemod_printer_withdraw","sendtable","DrGBaseChatPrint","TransferReport","VJSay","banleaver","gBan.BanBuffer","RDMAssign","MDE_RemoveStuff_C2S","timebombDefuse","dialogAlterWeapons","Kun_ZiptieStruggle","realistic_hook BreakFree","zrush_FuelSplitUIGotClosed_net","CRAFTINGMOD_INVENTORY","STOOL_FISHSPOT_REMOVE","DestroyTable","SetPlayerModel","AS_DoAttack","dialogAlterWeapons","camo_PlayerInvis","XMH_RunOneLineLua","WriteQuery","BailOut","75_plus_win","ATMDepositMoney","SellMinerals","TakeBetMoney","kart_sell","tickbooksendfine","hhh_request","DaHit","NET_EcSetTax","FARMINGMOD_ADDITEM","lp2PrinterCart","FOC_ClaimPay","fixg","dialogReward","PurchaseGun","popupgivereward","PurchaseAmmo","givemoneyonetime","take_my_cash","IntercomPlay","createvalue","race_accept","simfphys_request_seatswitch","flyover_git","079ServerAction","XMH_TeleportPlayer","race_accept","give_me_weapon","hpwrewrite_achievement1","CraftSomething","SquadGiveWeapon","giveweapon","CRAFTINGMOD_INVENTORY","dialogAlterWeapons","R_PERM.BuyFromShopNPC","XMH_HandleWeapons","PoliceJoin","CpForm_Answers","customprinter_get","NC_GetNameChange","ATS_WARP_REMOVE_CLIENT","CFCreateGame","CreateCase","rprotect_terminal_settings","StackGhost","tbfy_surrender","NewReport","CFCreateGame","PrtToPlayers","scoreboard.country","gMining.registerWeapon","JukeBox_PlayersTunedIn","pac_to_contraption","steamid2","start_alch","ctOS-Box-Hacked","ViewClaims","DW_GUNLAB_UPDATEORB","DW_PLAYSONG","selfportrait_idonthavehands","dw_toggle_item","tupacBail.bailPlayer","vloot_pickup_request","disguise","NET_AM_MakePotion","orgcheckname","dLogsGetCommand","ats_send_toServer","TFA_Attachment_RequestAll","NDES_SelectedEmblem","JoinOrg","steamid50","BM2.Command.SellBitcoins","metrostroi-specbutton-press","friendlist","join_disconnect","hvh_setloadout","Cl_PrometheusRequest","AdvDupe2_CanAutoSave","sphys_dupe","pp_info_send","controlled_vars","ContentRmvProps","bodygroups_change","PS_ModifyItem","aom_set_bool","hhh_request","StatusScreen_Ping","ScreengrabInitCallback","sgGiveFriendStatusAll","NStatistics_SendPlayerStatistic","SCarSpawnSendFile","ts_buytitle","UpdateNameColor","noob_playerperks","perm_buyweapon","CarDisplayPurchaseCar","bm_DoAddMarket","gindustrial_item_sources","StartHackingMission","ncpstoredoact","usec_keypad","movePiece","gPrinters.addUpgrade","PS2_ItemServerRPC","npcData","gamemode_reload_string","AS_DoAttack","lfs_player_request_filter","hpwrewrite_achievement1","wanted_radio","lockpick_sound","fp_as_doorHandler","OpenGates","Kun_FinishLockpicking","ReturnFrom_Succes","dialogAlterWeapons","InitSpin","simfphys_gasspill","EL_editUser","CRAFTINGMOD_COMMANDS","Taucannonfire","mat_zset","dialogClose","StaminaDrowning","shr","dumpster_beginsearch","disguise","gportal_rpname_change","WS:NPC:Name:NewName","NewRPNameSQL","rpname_change","popupinfo","scoreboardadmin","UpdateCharSF","SprintSpeedset","AbilityUse","RevivePlayer","revival_revive_accept","MakeZombie","UseMedkit","079ServerAction","ItemStoreSyncItem","ItemStoreSplit","NLR.ActionPlayer","plyWarning","NLRKick","RecKickAFKer","simfphys_turnsignal","send","sendteslaeffect","NLR_SPAWN","ARMORY_RetrieveWeapon","BuilderXToggleKill","1942_Fuhrer_SubmitCandidacy","fly_over_end","SimplicityAC_aysent","rHit.Confirm.Placement","thiefnpc","nSetExpression","TowTruck_CreateTowTruck","StaminaDrowning","CRAFTINGMOD_INVENTORY","npctool_relman_up","CreateBadgeSpray","CallP","sounds_yo","dialogAlterWeapons","hcLog","drugseffect_remove","Cover_WheelU","DCHOLDSTER","STOOL_FISHSPOT_REMOVE","DestroyTable","AS_DoAttack"}
bSecure.AntiExploit.Baits = {}

local baitCount = 0
function bSecure.AntiExploit.CreateBait(strNet)
    if net.Receivers[strNet:lower()] then return end
    baitCount = baitCount + 1
    util.AddNetworkString(strNet)
    bSecure.AntiExploit.Baits[baitCount] = strNet

    net.Receive(strNet, function(_, Daave)
        bSecure.PrintDetection("Detected an exploit menu. " .. bSecure.FormatPlayer(Daave) .. " : " .. strNet)
        bSecure.CreateDataLog{Player = Daave, Code = "106A", Details = "Detected the suspect attempting to send net messages to exploit the server.\nNetMessage: "..strNet}
    end)
end

local attempts = 0
::retry::
attempts = attempts + 1
for k,v in ipairs(bSecure.AntiExploit.FlaggedNets) do
    if math.random() < 0.1 then -- can't use all of them or thats sus
        bSecure.AntiExploit.CreateBait(v)
    end
end

if baitCount == 0 and attempts < 12 then -- otherwise its basically just a while true loop
    goto retry
end